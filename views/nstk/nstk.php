<?php 

    include_once("../../database/config.php");

    session_start();
    if(!isset($_SESSION['username'])){
        header("Location: http://".$_SERVER['HTTP_HOST']."/views/login/signin.php");
    }

    $userID = $_SESSION["userID"];
    $notes_title = array();

    $stmt = $connection->prepare("SELECT notes.notes_title, notes.id FROM notes JOIN account ON notes.userID = account.id WHERE account.id = ?");
    $stmt->bind_param("i", $userID);

    $stmt->execute();
    $result = $stmt->get_result();

    if($result->num_rows > 0) {
        while($notesData = $result->fetch_assoc()){
            $notes_title[] = array("userID"=>$notesData['id'], "notesTitle"=>$notesData['notes_title']);
        }
    }

?>

<?php include_once("../partials/head.php") ?>
    <title>NsTK | Notes taking app</title>
</head>
<body>
    <header class="home-header">
        <nav class="home-nav">
            <div class="wrapper home-nav-container">
                <h3>NsTK</h3>
                <div class="left-menu">
                    <a href="../addnotes/addnotes.php" class="home-write-notes">
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.2188 6.88009L12.12 1.78127C11.8964 1.56098 11.5952 1.4375 11.2813 1.4375C10.9674 1.4375 10.6662 1.56098 10.4426 1.78127L8.57974 3.64416L4.26763 5.26212C4.07349 5.33501 3.90198 5.45777 3.77039 5.61803C3.63879 5.77829 3.55174 5.9704 3.51802 6.17501L1.97427 15.4227C1.96305 15.4852 1.97218 15.5497 2.00033 15.6066C2.02847 15.6636 2.07414 15.71 2.13062 15.7391C2.1871 15.7681 2.25142 15.7783 2.31412 15.7681C2.37682 15.7579 2.43459 15.7279 2.47896 15.6824L6.56099 11.593C6.34607 11.2288 6.23326 10.8135 6.23443 10.3906C6.23443 9.92091 6.37372 9.46173 6.63469 9.07116C6.89566 8.68059 7.26658 8.37618 7.70055 8.19643C8.13453 8.01667 8.61206 7.96964 9.07277 8.06128C9.53347 8.15291 9.95666 8.37911 10.2888 8.71126C10.621 9.04341 10.8472 9.4666 10.9388 9.9273C11.0304 10.388 10.9834 10.8655 10.8036 11.2995C10.6239 11.7335 10.3195 12.1044 9.92891 12.3654C9.53834 12.6263 9.07916 12.7656 8.60943 12.7656C8.18658 12.7668 7.77124 12.654 7.40708 12.4391L3.31763 16.5211C3.27217 16.5655 3.24213 16.6233 3.23194 16.686C3.22174 16.7487 3.23193 16.813 3.261 16.8695C3.29007 16.9259 3.3365 16.9716 3.39345 16.9997C3.4504 17.0279 3.51487 17.037 3.5774 17.0258L12.8251 15.4895C13.0297 15.453 13.2213 15.364 13.3813 15.2313C13.5413 15.0987 13.6642 14.9268 13.7379 14.7324L15.3559 10.4203L17.2188 8.55744C17.3297 8.44771 17.4177 8.31708 17.4777 8.17313C17.5378 8.02918 17.5687 7.87474 17.5687 7.71877C17.5687 7.56279 17.5378 7.40835 17.4777 7.2644C17.4177 7.12045 17.3297 6.98983 17.2188 6.88009ZM14.8438 9.25509L9.74498 4.15627L11.2813 2.61994L16.3801 7.71877L14.8438 9.25509ZM8.60943 11.5781C8.37456 11.5781 8.14497 11.5085 7.94969 11.378C7.75441 11.2475 7.6022 11.0621 7.51232 10.8451C7.42244 10.6281 7.39893 10.3893 7.44475 10.159C7.49057 9.92862 7.60366 9.71703 7.76974 9.55095C7.93581 9.38488 8.14741 9.27178 8.37776 9.22596C8.60811 9.18014 8.84688 9.20365 9.06386 9.29353C9.28085 9.38341 9.46631 9.53562 9.5968 9.7309C9.72728 9.92618 9.79693 10.1558 9.79693 10.3906C9.79693 10.7056 9.67182 11.0076 9.44912 11.2303C9.22642 11.453 8.92437 11.5781 8.60943 11.5781Z" fill="#F1F1F1"/>
                        </svg>
                        Write notes
                    </a>
                    <a href="./services/logout.php" class="logout-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20.3438 17.1563H18.6961C18.5836 17.1563 18.4781 17.2055 18.4078 17.2922C18.2438 17.4914 18.068 17.6836 17.8828 17.8664C17.1255 18.6245 16.2285 19.2286 15.2414 19.6453C14.2187 20.0773 13.1195 20.2989 12.0094 20.2969C10.8867 20.2969 9.79922 20.0766 8.77735 19.6453C7.79023 19.2286 6.89322 18.6245 6.13594 17.8664C5.3773 17.1109 4.77239 16.2155 4.35469 15.2297C3.9211 14.2078 3.70313 13.1227 3.70313 12C3.70313 10.8773 3.92344 9.79219 4.35469 8.77032C4.77188 7.7836 5.37188 6.89532 6.13594 6.1336C6.9 5.37188 7.78828 4.77188 8.77735 4.35469C9.79922 3.92344 10.8867 3.70313 12.0094 3.70313C13.132 3.70313 14.2195 3.9211 15.2414 4.35469C16.2305 4.77188 17.1188 5.37188 17.8828 6.1336C18.068 6.31876 18.2414 6.51094 18.4078 6.70782C18.4781 6.79454 18.5859 6.84375 18.6961 6.84375H20.3438C20.4914 6.84375 20.5828 6.67969 20.5008 6.55547C18.7031 3.76172 15.5578 1.9125 11.9836 1.92188C6.36797 1.93594 1.86563 6.49454 1.92188 12.1031C1.97813 17.6227 6.47344 22.0781 12.0094 22.0781C15.5742 22.0781 18.7055 20.2313 20.5008 17.4445C20.5805 17.3203 20.4914 17.1563 20.3438 17.1563ZM22.4273 11.8523L19.1016 9.22735C18.9773 9.12891 18.7969 9.21797 18.7969 9.37501V11.1563H11.4375C11.3344 11.1563 11.25 11.2406 11.25 11.3438V12.6563C11.25 12.7594 11.3344 12.8438 11.4375 12.8438H18.7969V14.625C18.7969 14.782 18.9797 14.8711 19.1016 14.7727L22.4273 12.1477C22.4498 12.1301 22.4679 12.1077 22.4803 12.0821C22.4928 12.0565 22.4993 12.0285 22.4993 12C22.4993 11.9715 22.4928 11.9435 22.4803 11.9179C22.4679 11.8923 22.4498 11.8699 22.4273 11.8523Z" fill="#F56A6A"/>
                        </svg>
                    </a>
                </div>
            </div>
        </nav>
    </header>
    <section class="notes-list-section">
        <div class="wrapper notes-list">
            <div class="heading">
                <h2>Notes list</h2>
            </div>
            <div class="notes">
                <?php if(count($notes_title) > 0){ ?>
                    <?php foreach($notes_title as $notes){ ?>
                        <div class="notes-card">
                            <div class="notes-nav-card">
                                <a href="../updateNotes/updateNotes.php?userID=<?php echo $notes["userID"] ?>" class="edit">
                                    <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1.625 9.34376V11.375H3.65625L9.64708 5.38417L7.61583 3.35292L1.625 9.34376ZM11.5971 3.43417L9.56583 1.40292L8.19542 2.77876L10.2267 4.81001L11.5971 3.43417Z" fill="white"/>
                                    </svg>
                                </a>
                                <a href="./services/deleteNotes.php?userID=<?php echo $notes["userID"] ?>" class="delete">
                                    <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5.48436 1.62501H7.51561C7.54237 1.62471 7.56892 1.62975 7.59371 1.63985C7.61849 1.64995 7.641 1.6649 7.65993 1.68382C7.67885 1.70275 7.6938 1.72526 7.7039 1.75004C7.714 1.77483 7.71904 1.80138 7.71874 1.82814V2.43751H5.28124V1.82814C5.28093 1.80138 5.28598 1.77483 5.29607 1.75004C5.30617 1.72526 5.32113 1.70275 5.34005 1.68382C5.35897 1.6649 5.38149 1.64995 5.40627 1.63985C5.43105 1.62975 5.4576 1.62471 5.48436 1.62501Z" fill="white"/>
                                        <path d="M5.58594 1.625H7.41406C7.441 1.625 7.46683 1.6357 7.48588 1.65475C7.50492 1.67379 7.51562 1.69963 7.51562 1.72656V2.4375H5.48438V1.72656C5.48438 1.69963 5.49508 1.67379 5.51412 1.65475C5.53317 1.6357 5.559 1.625 5.58594 1.625Z" fill="white"/>
                                        <path d="M1.63643 2.4375H4.46875V1.21875C4.46875 1.11101 4.51155 1.00767 4.58774 0.931488C4.66392 0.855301 4.76726 0.8125 4.875 0.8125H8.125C8.23274 0.8125 8.33608 0.855301 8.41226 0.931488C8.48845 1.00767 8.53125 1.11101 8.53125 1.21875V2.4375H11.3636L11.375 3.45312H10.5371L10.027 11.4258C10.0141 11.632 9.92314 11.8255 9.77263 11.967C9.62213 12.1085 9.42337 12.1873 9.2168 12.1875H3.7832C3.57674 12.1875 3.37804 12.1088 3.22746 11.9676C3.07687 11.8264 2.98571 11.6331 2.97248 11.4271L2.46289 3.45312H1.625L1.63643 2.4375ZM8.53125 10.5625L8.75977 4.0625H7.92188L7.69336 10.5625H8.53125ZM6.09375 10.5625H6.90625V4.0625H6.09375V10.5625ZM5.48438 2.4375H7.51562V1.72656C7.51562 1.69963 7.50492 1.67379 7.48588 1.65475C7.46683 1.6357 7.441 1.625 7.41406 1.625H5.58594C5.559 1.625 5.53317 1.6357 5.51412 1.65475C5.49508 1.67379 5.48438 1.69963 5.48438 1.72656V2.4375ZM4.46875 10.5625H5.30664L5.07812 4.0625H4.24023L4.46875 10.5625Z" fill="white"/>
                                    </svg>
                                </a>
                            </div>
                            <h2><?php echo $notes["notesTitle"] ?></h2>
                            <div class="read-more">
                                <a href="../content/notesContent.php?id=<?php echo $notes["userID"]; ?>">
                                    <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M15.4062 2.67285H11.6078C10.7927 2.67285 9.9958 2.90693 9.31016 3.34854L8.5 3.86816L7.68984 3.34854C7.00488 2.90702 6.20712 2.67242 5.39219 2.67285H1.59375C1.2999 2.67285 1.0625 2.91025 1.0625 3.2041V12.6338C1.0625 12.9276 1.2999 13.165 1.59375 13.165H5.39219C6.20732 13.165 7.0042 13.3991 7.68984 13.8407L8.42695 14.3155C8.44854 14.3288 8.47344 14.3371 8.49834 14.3371C8.52324 14.3371 8.54814 14.3305 8.56973 14.3155L9.30684 13.8407C9.99414 13.3991 10.7927 13.165 11.6078 13.165H15.4062C15.7001 13.165 15.9375 12.9276 15.9375 12.6338V3.2041C15.9375 2.91025 15.7001 2.67285 15.4062 2.67285ZM5.39219 11.9697H2.25781V3.86816H5.39219C5.97988 3.86816 6.55098 4.03584 7.04404 4.35293L7.8542 4.87256L7.96875 4.94727V12.6172C7.17852 12.1922 6.29531 11.9697 5.39219 11.9697ZM14.7422 11.9697H11.6078C10.7047 11.9697 9.82148 12.1922 9.03125 12.6172V4.94727L9.1458 4.87256L9.95596 4.35293C10.449 4.03584 11.0201 3.86816 11.6078 3.86816H14.7422V11.9697ZM6.58916 5.99316H3.50459C3.43984 5.99316 3.38672 6.04961 3.38672 6.11768V6.86475C3.38672 6.93281 3.43984 6.98926 3.50459 6.98926H6.5875C6.65225 6.98926 6.70537 6.93281 6.70537 6.86475V6.11768C6.70703 6.04961 6.65391 5.99316 6.58916 5.99316ZM10.293 6.11768V6.86475C10.293 6.93281 10.3461 6.98926 10.4108 6.98926H13.4937C13.5585 6.98926 13.6116 6.93281 13.6116 6.86475V6.11768C13.6116 6.04961 13.5585 5.99316 13.4937 5.99316H10.4108C10.3461 5.99316 10.293 6.04961 10.293 6.11768ZM6.58916 8.31738H3.50459C3.43984 8.31738 3.38672 8.37383 3.38672 8.4419V9.18897C3.38672 9.25703 3.43984 9.31348 3.50459 9.31348H6.5875C6.65225 9.31348 6.70537 9.25703 6.70537 9.18897V8.4419C6.70703 8.37383 6.65391 8.31738 6.58916 8.31738ZM13.4954 8.31738H10.4108C10.3461 8.31738 10.293 8.37383 10.293 8.4419V9.18897C10.293 9.25703 10.3461 9.31348 10.4108 9.31348H13.4937C13.5585 9.31348 13.6116 9.25703 13.6116 9.18897V8.4419C13.6133 8.37383 13.5602 8.31738 13.4954 8.31738Z" fill="#45443F"/>
                                    </svg>
                                    Read more
                                </a>
                            </div>
                        </div>
                    <?php } ?>
                <?php } else { ?>
                    <div class="no-notes-found">
                        <h3>No notes found...</h3>
                    </div>
                <?php } ?>
                
           
            </div>
        </div>
    </section>
</body>
<?php include_once("../partials/footer.php") ?>